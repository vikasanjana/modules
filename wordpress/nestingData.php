<?php
$product_cat = '[{"term_id":15,"name":"Uncategorize","slug":"uncategorize","term_group":0,"term_taxonomy_id":15,"taxonomy":"product_cat","description":"","parent":0,"count":0,"filter":"raw"},{"term_id":25,"name":"Accessories","slug":"accessories","term_group":0,"term_taxonomy_id":25,"taxonomy":"product_cat","description":"L\u00f6rem ipsum neofoni iteledes. Supran rarade av andrafiering bev. Popull preheten l\u00e4de p","parent":0,"count":3,"filter":"raw"},{"term_id":95,"name":"Accessories","slug":"accessories-audio","term_group":0,"term_taxonomy_id":95,"taxonomy":"product_cat","description":"","parent":19,"count":1,"filter":"raw"},{"term_id":66,"name":"Adapters","slug":"adapters","term_group":0,"term_taxonomy_id":66,"taxonomy":"product_cat","description":"","parent":17,"count":0,"filter":"raw"},{"term_id":19,"name":"Audio","slug":"audio","term_group":0,"term_taxonomy_id":19,"taxonomy":"product_cat","description":"L\u00f6rem ipsum neofoni iteledes. Supran rarade av andrafiering bev. Popull preheten l\u00e4de p","parent":0,"count":1,"filter":"raw"},{"term_id":71,"name":"Backdrops","slug":"backdrops","term_group":0,"term_taxonomy_id":71,"taxonomy":"product_cat","description":"","parent":18,"count":0,"filter":"raw"},{"term_id":91,"name":"Bags & Cases","slug":"bags_and_cases","term_group":0,"term_taxonomy_id":91,"taxonomy":"product_cat","description":"","parent":25,"count":0,"filter":"raw"},{"term_id":85,"name":"Batteries","slug":"batteries","term_group":0,"term_taxonomy_id":85,"taxonomy":"product_cat","description":"","parent":25,"count":0,"filter":"raw"},{"term_id":83,"name":"C Stand","slug":"c_stand","term_group":0,"term_taxonomy_id":83,"taxonomy":"product_cat","description":"","parent":25,"count":2,"filter":"raw"},{"term_id":92,"name":"Cables \/ Tethering","slug":"cables-tethering","term_group":0,"term_taxonomy_id":92,"taxonomy":"product_cat","description":"","parent":25,"count":0,"filter":"raw"},{"term_id":74,"name":"Camera Rigs","slug":"camera_rigs","term_group":0,"term_taxonomy_id":74,"taxonomy":"product_cat","description":"","parent":20,"count":0,"filter":"raw"},{"term_id":43,"name":"Canon","slug":"canon","term_group":0,"term_taxonomy_id":43,"taxonomy":"product_cat","description":"","parent":16,"count":2,"filter":"raw"},{"term_id":54,"name":"Canon EF Mount","slug":"canon_ef_mount","term_group":0,"term_taxonomy_id":54,"taxonomy":"product_cat","description":"","parent":17,"count":3,"filter":"raw"},{"term_id":55,"name":"Canon RF Mount","slug":"canon_rf_mount","term_group":0,"term_taxonomy_id":55,"taxonomy":"product_cat","description":"","parent":17,"count":0,"filter":"raw"},{"term_id":87,"name":"Card Readers","slug":"card_readers","term_group":0,"term_taxonomy_id":87,"taxonomy":"product_cat","description":"","parent":25,"count":0,"filter":"raw"},{"term_id":67,"name":"Continuous","slug":"continuous","term_group":0,"term_taxonomy_id":67,"taxonomy":"product_cat","description":"","parent":18,"count":0,"filter":"raw"},{"term_id":16,"name":"Digital Camera","slug":"digital-camera","term_group":0,"term_taxonomy_id":16,"taxonomy":"product_cat","description":"L\u00f6rem ipsum neofoni iteledes. Supran rarade av andrafiering bev. Popull preheten l\u00e4de p","parent":0,"count":2,"filter":"raw"},{"term_id":49,"name":"DJI","slug":"dji","term_group":0,"term_taxonomy_id":49,"taxonomy":"product_cat","description":"","parent":16,"count":0,"filter":"raw"},{"term_id":53,"name":"Drones","slug":"drones","term_group":0,"term_taxonomy_id":53,"taxonomy":"product_cat","description":"","parent":16,"count":0,"filter":"raw"},{"term_id":88,"name":"Extension Units","slug":"extension_units","term_group":0,"term_taxonomy_id":88,"taxonomy":"product_cat","description":"","parent":25,"count":0,"filter":"raw"},{"term_id":89,"name":"Filters","slug":"filters","term_group":0,"term_taxonomy_id":89,"taxonomy":"product_cat","description":"","parent":25,"count":0,"filter":"raw"},{"term_id":68,"name":"Flashes","slug":"flashes","term_group":0,"term_taxonomy_id":68,"taxonomy":"product_cat","description":"","parent":18,"count":0,"filter":"raw"},{"term_id":60,"name":"Fuji G Mount","slug":"fuji_g_mount","term_group":0,"term_taxonomy_id":60,"taxonomy":"product_cat","description":"","parent":17,"count":0,"filter":"raw"},{"term_id":61,"name":"Fuji X Mount","slug":"fuji_x_mount","term_group":0,"term_taxonomy_id":61,"taxonomy":"product_cat","description":"","parent":17,"count":0,"filter":"raw"},{"term_id":46,"name":"Fujifilm","slug":"fujifilm","term_group":0,"term_taxonomy_id":46,"taxonomy":"product_cat","description":"","parent":16,"count":0,"filter":"raw"},{"term_id":73,"name":"Gimbals","slug":"gimbals","term_group":0,"term_taxonomy_id":73,"taxonomy":"product_cat","description":"","parent":20,"count":0,"filter":"raw"},{"term_id":51,"name":"GoPro","slug":"gopro","term_group":0,"term_taxonomy_id":51,"taxonomy":"product_cat","description":"","parent":16,"count":0,"filter":"raw"},{"term_id":65,"name":"L Mount","slug":"l_mount","term_group":0,"term_taxonomy_id":65,"taxonomy":"product_cat","description":"","parent":17,"count":0,"filter":"raw"},{"term_id":48,"name":"Leica","slug":"leica","term_group":0,"term_taxonomy_id":48,"taxonomy":"product_cat","description":"","parent":16,"count":0,"filter":"raw"},{"term_id":64,"name":"Leica M Mount","slug":"leica_m_mount","term_group":0,"term_taxonomy_id":64,"taxonomy":"product_cat","description":"","parent":17,"count":0,"filter":"raw"},{"term_id":17,"name":"Lens","slug":"lens","term_group":0,"term_taxonomy_id":17,"taxonomy":"product_cat","description":"L\u00f6rem ipsum neofoni iteledes. Supran rarade av andrafiering bev. Popull preheten l\u00e4de p","parent":0,"count":4,"filter":"raw"},{"term_id":70,"name":"Light Stands","slug":"light_stands","term_group":0,"term_taxonomy_id":70,"taxonomy":"product_cat","description":"","parent":18,"count":0,"filter":"raw"},{"term_id":18,"name":"Lightning","slug":"lightning","term_group":0,"term_taxonomy_id":18,"taxonomy":"product_cat","description":"L\u00f6rem ipsum neofoni iteledes. Supran rarade av andrafiering bev. Popull preheten l\u00e4de p","parent":0,"count":1,"filter":"raw"},{"term_id":78,"name":"Macbook","slug":"macbook","term_group":0,"term_taxonomy_id":78,"taxonomy":"product_cat","description":"","parent":20,"count":0,"filter":"raw"},{"term_id":90,"name":"Matte Boxes","slug":"matte-boxes","term_group":0,"term_taxonomy_id":90,"taxonomy":"product_cat","description":"","parent":25,"count":0,"filter":"raw"},{"term_id":86,"name":"Memory Cards","slug":"memory_cards","term_group":0,"term_taxonomy_id":86,"taxonomy":"product_cat","description":"","parent":25,"count":1,"filter":"raw"},{"term_id":62,"name":"Micro 4\/3rds Mount","slug":"micro_4-3rds_mount","term_group":0,"term_taxonomy_id":62,"taxonomy":"product_cat","description":"","parent":17,"count":0,"filter":"raw"},{"term_id":93,"name":"Microphones","slug":"microphones","term_group":0,"term_taxonomy_id":93,"taxonomy":"product_cat","description":"","parent":19,"count":0,"filter":"raw"},{"term_id":72,"name":"Modifiers","slug":"modifiers","term_group":0,"term_taxonomy_id":72,"taxonomy":"product_cat","description":"","parent":18,"count":0,"filter":"raw"},{"term_id":76,"name":"Monitors","slug":"monitors","term_group":0,"term_taxonomy_id":76,"taxonomy":"product_cat","description":"","parent":20,"count":0,"filter":"raw"},{"term_id":84,"name":"Monopod","slug":"monopod","term_group":0,"term_taxonomy_id":84,"taxonomy":"product_cat","description":"","parent":25,"count":0,"filter":"raw"},{"term_id":44,"name":"Nikon","slug":"nikon","term_group":0,"term_taxonomy_id":44,"taxonomy":"product_cat","description":"","parent":16,"count":0,"filter":"raw"},{"term_id":56,"name":"Nikon F Mount","slug":"nikon_f_mount","term_group":0,"term_taxonomy_id":56,"taxonomy":"product_cat","description":"","parent":17,"count":1,"filter":"raw"},{"term_id":57,"name":"Nikon Z Mount","slug":"nikon_z_mount","term_group":0,"term_taxonomy_id":57,"taxonomy":"product_cat","description":"","parent":17,"count":0,"filter":"raw"},{"term_id":37,"name":"Other","slug":"other","term_group":0,"term_taxonomy_id":37,"taxonomy":"product_cat","description":"","parent":25,"count":0,"filter":"raw"},{"term_id":47,"name":"Panasonic","slug":"panasonic","term_group":0,"term_taxonomy_id":47,"taxonomy":"product_cat","description":"","parent":16,"count":0,"filter":"raw"},{"term_id":63,"name":"PL Mount","slug":"pl_mount","term_group":0,"term_taxonomy_id":63,"taxonomy":"product_cat","description":"","parent":17,"count":0,"filter":"raw"},{"term_id":39,"name":"Popular Items","slug":"popular-items","term_group":0,"term_taxonomy_id":39,"taxonomy":"product_cat","description":"","parent":0,"count":5,"filter":"raw"},{"term_id":20,"name":"Production","slug":"production","term_group":0,"term_taxonomy_id":20,"taxonomy":"product_cat","description":"L\u00f6rem ipsum neofoni iteledes. Supran rarade av andrafiering bev. Popull preheten l\u00e4de p","parent":0,"count":2,"filter":"raw"},{"term_id":77,"name":"production accessorises","slug":"production_accessorises","term_group":0,"term_taxonomy_id":77,"taxonomy":"product_cat","description":"","parent":20,"count":0,"filter":"raw"},{"term_id":94,"name":"Recorders","slug":"recorders","term_group":0,"term_taxonomy_id":94,"taxonomy":"product_cat","description":"","parent":19,"count":0,"filter":"raw"},{"term_id":81,"name":"Shot Bag","slug":"shot_bag","term_group":0,"term_taxonomy_id":81,"taxonomy":"product_cat","description":"","parent":20,"count":0,"filter":"raw"},{"term_id":50,"name":"Sigma","slug":"sigma","term_group":0,"term_taxonomy_id":50,"taxonomy":"product_cat","description":"","parent":16,"count":0,"filter":"raw"},{"term_id":75,"name":"Sliders","slug":"sliders","term_group":0,"term_taxonomy_id":75,"taxonomy":"product_cat","description":"","parent":20,"count":0,"filter":"raw"},{"term_id":45,"name":"Sony","slug":"sony","term_group":0,"term_taxonomy_id":45,"taxonomy":"product_cat","description":"","parent":16,"count":1,"filter":"raw"},{"term_id":59,"name":"Sony A Mount","slug":"sony_a_mount","term_group":0,"term_taxonomy_id":59,"taxonomy":"product_cat","description":"","parent":17,"count":0,"filter":"raw"},{"term_id":58,"name":"Sony E Mount","slug":"sony-e_mount","term_group":0,"term_taxonomy_id":58,"taxonomy":"product_cat","description":"","parent":17,"count":0,"filter":"raw"},{"term_id":80,"name":"Streaming\/ Wireless","slug":"streaming-wireless","term_group":0,"term_taxonomy_id":80,"taxonomy":"product_cat","description":"","parent":20,"count":0,"filter":"raw"},{"term_id":69,"name":"Strobes","slug":"strobes","term_group":0,"term_taxonomy_id":69,"taxonomy":"product_cat","description":"","parent":18,"count":0,"filter":"raw"},{"term_id":96,"name":"test-sub-cat","slug":"test-sub-cat","term_group":0,"term_taxonomy_id":96,"taxonomy":"product_cat","description":"","parent":91,"count":0,"filter":"raw"},{"term_id":82,"name":"Tripods","slug":"tripods","term_group":0,"term_taxonomy_id":82,"taxonomy":"product_cat","description":"","parent":25,"count":0,"filter":"raw"},{"term_id":79,"name":"View Finder","slug":"view_finder","term_group":0,"term_taxonomy_id":79,"taxonomy":"product_cat","description":"","parent":20,"count":0,"filter":"raw"},{"term_id":52,"name":"VR & 360","slug":"vr_360","term_group":0,"term_taxonomy_id":52,"taxonomy":"product_cat","description":"","parent":16,"count":0,"filter":"raw"}]';


$data = json_decode($product_cat , true);


function getCategories($product_cat){
    $all_cat = array();
    foreach($product_cat as $key => $value){
        if(!empty(getParentCat($product_cat, $value))){
            $parent_cat[] = getParentCat($product_cat, $value);
        }
    }
    return $parent_cat;
}

function getParentCat($product_cat, $data){
    $parent_cat = array();
    if($data['parent'] == 0){
        $main_cat = array(
            'id' => $data['term_id'],
            'name' => $data['name'],
            'sub_category' => getSubCategories($product_cat, $data['term_id'])
        );
        // array_push($parent_cat, $main_cat);
        $parent_cat[$data['slug']] = $main_cat;
    } 
    return $parent_cat;
}

function getSubCategories($product_cat, $parent_id){
    $sub_categories = array();
    foreach($product_cat as $category){
        if($category['parent'] == $parent_id){
            $sub_category = array(
                'id' => $category['term_id'],
                'name' => $category['name'],
                'sub_category' => getSubCategories($product_cat, $category['term_id'])
            );
            // array_push($sub_categories, $sub_category);
            $sub_categories[$category['slug']] = $sub_category;
        }
    }
    return $sub_categories;
}
echo "<pre>";
$result = getCategories($data);
print_r($result);
